{"version":3,"file":"3-f5df0450.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/(user)/_layout.server.ts.js","../../../.svelte-kit/adapter-node/nodes/3.js"],"sourcesContent":["import { signInWithEmailAndPassword, createUserWithEmailAndPassword } from \"firebase/auth\";\nimport Cookies from \"js-cookie\";\nimport \"firebase/app\";\nlet auth;\nasync function loginWithEmailAndPassword(email, password) {\n  return signInWithEmailAndPassword(auth, email, password).then(async (user) => {\n    const dbUser = {\n      email: user.user.email ?? \"NO-EMAIL\"\n    };\n    const token = await user.user.getIdToken();\n    Cookies.set(\"AccessToken\", token);\n    return backendLogin(dbUser).then(() => {\n      return user;\n    });\n  });\n}\nasync function backendLogin(user) {\n  return fetch(\"/api/login\", {\n    credentials: \"include\",\n    method: \"POST\",\n    body: JSON.stringify(user)\n  });\n}\nfunction newUserWithEmailAndPassword(email, password) {\n  return createUserWithEmailAndPassword(auth, email, password).then(async (user) => {\n    const dbUser = {\n      email: user.user.email ?? \"NO-EMAIL\"\n    };\n    return fetch(\"/api/user/login\", {\n      method: \"POST\",\n      body: JSON.stringify(dbUser)\n    }).then(() => user);\n  });\n}\nfunction logout() {\n  Cookies.remove(\"AccessToken\");\n  return auth.signOut();\n}\nfunction generateUserAndSendPasswordEmail(hotelUuid, email) {\n  return fetch(\"/api/hotel/\" + hotelUuid + \"/users\", {\n    method: \"POST\",\n    body: JSON.stringify({ email })\n  });\n}\nfunction getUser(fetch2) {\n  if (!fetch2) {\n    fetch2 = window.fetch;\n  }\n  return fetch2(\"/api/user\", {\n    credentials: \"include\"\n  }).then(async (response) => {\n    if (response.status === 401) {\n      return null;\n    }\n    return response.json();\n  }).catch(console.error);\n}\nconst UserService = {\n  loginWithEmailAndPassword,\n  newUserWithEmailAndPassword,\n  getUser,\n  logout,\n  generateUserAndSendPasswordEmail\n};\nasync function load({ cookies, fetch: fetch2 }) {\n  const language = cookies.get(\"LANG\") ?? \"de\";\n  const user = await UserService.getUser(fetch2);\n  return { language, user };\n}\nexport {\n  load\n};\n","import * as server from '../entries/pages/(user)/_layout.server.ts.js';\n\nexport const index = 3;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/(user)/_layout.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/(user)/+layout.server.ts\";\nexport const imports = [\"_app/immutable/nodes/3.b506d2b5.js\",\"_app/immutable/chunks/scheduler.e108d1fd.js\",\"_app/immutable/chunks/index.2b52f78d.js\",\"_app/immutable/chunks/app.7d0d17cc.js\",\"_app/immutable/chunks/navigation.e0f8f435.js\",\"_app/immutable/chunks/singletons.2f93ef9a.js\",\"_app/immutable/chunks/js.cookie.edb2da2a.js\"];\nexport const stylesheets = [\"_app/immutable/assets/app.c5e7b66d.css\"];\nexport const fonts = [];\n"],"names":[],"mappings":";;;;AAGA,IAAI,IAAI,CAAC;AACT,eAAe,yBAAyB,CAAC,KAAK,EAAE,QAAQ,EAAE;AAC1D,EAAE,OAAO,0BAA0B,CAAC,IAAI,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,KAAK;AAChF,IAAI,MAAM,MAAM,GAAG;AACnB,MAAM,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,UAAU;AAC1C,KAAK,CAAC;AACN,IAAI,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE,CAAC;AAC/C,IAAI,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AACtC,IAAI,OAAO,YAAY,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM;AAC3C,MAAM,OAAO,IAAI,CAAC;AAClB,KAAK,CAAC,CAAC;AACP,GAAG,CAAC,CAAC;AACL,CAAC;AACD,eAAe,YAAY,CAAC,IAAI,EAAE;AAClC,EAAE,OAAO,KAAK,CAAC,YAAY,EAAE;AAC7B,IAAI,WAAW,EAAE,SAAS;AAC1B,IAAI,MAAM,EAAE,MAAM;AAClB,IAAI,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;AAC9B,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,2BAA2B,CAAC,KAAK,EAAE,QAAQ,EAAE;AACtD,EAAE,OAAO,8BAA8B,CAAC,IAAI,EAAE,KAAK,EAAE,QAAQ,CAAC,CAAC,IAAI,CAAC,OAAO,IAAI,KAAK;AACpF,IAAI,MAAM,MAAM,GAAG;AACnB,MAAM,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,UAAU;AAC1C,KAAK,CAAC;AACN,IAAI,OAAO,KAAK,CAAC,iBAAiB,EAAE;AACpC,MAAM,MAAM,EAAE,MAAM;AACpB,MAAM,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;AAClC,KAAK,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,CAAC;AACxB,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,MAAM,GAAG;AAClB,EAAE,OAAO,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;AAChC,EAAE,OAAO,IAAI,CAAC,OAAO,EAAE,CAAC;AACxB,CAAC;AACD,SAAS,gCAAgC,CAAC,SAAS,EAAE,KAAK,EAAE;AAC5D,EAAE,OAAO,KAAK,CAAC,aAAa,GAAG,SAAS,GAAG,QAAQ,EAAE;AACrD,IAAI,MAAM,EAAE,MAAM;AAClB,IAAI,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE,KAAK,EAAE,CAAC;AACnC,GAAG,CAAC,CAAC;AACL,CAAC;AACD,SAAS,OAAO,CAAC,MAAM,EAAE;AACzB,EAAE,IAAI,CAAC,MAAM,EAAE;AACf,IAAI,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC;AAC1B,GAAG;AACH,EAAE,OAAO,MAAM,CAAC,WAAW,EAAE;AAC7B,IAAI,WAAW,EAAE,SAAS;AAC1B,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,QAAQ,KAAK;AAC9B,IAAI,IAAI,QAAQ,CAAC,MAAM,KAAK,GAAG,EAAE;AACjC,MAAM,OAAO,IAAI,CAAC;AAClB,KAAK;AACL,IAAI,OAAO,QAAQ,CAAC,IAAI,EAAE,CAAC;AAC3B,GAAG,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;AAC1B,CAAC;AACD,MAAM,WAAW,GAAG;AACpB,EAAE,yBAAyB;AAC3B,EAAE,2BAA2B;AAC7B,EAAE,OAAO;AACT,EAAE,MAAM;AACR,EAAE,gCAAgC;AAClC,CAAC,CAAC;AACF,eAAe,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE;AAChD,EAAE,MAAM,QAAQ,GAAG,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;AAC/C,EAAE,MAAM,IAAI,GAAG,MAAM,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;AACjD,EAAE,OAAO,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;AAC5B;;;;;;;AClEY,MAAC,KAAK,GAAG,EAAE;AACvB,IAAI,eAAe,CAAC;AACR,MAAC,SAAS,GAAG,YAAY,eAAe,KAAK,CAAC,MAAM,OAAO,8BAA2C,CAAC,EAAE,QAAQ;AAEjH,MAAC,SAAS,GAAG,sCAAsC;AACnD,MAAC,OAAO,GAAG,CAAC,oCAAoC,CAAC,6CAA6C,CAAC,yCAAyC,CAAC,uCAAuC,CAAC,8CAA8C,CAAC,8CAA8C,CAAC,6CAA6C,EAAE;AAC9T,MAAC,WAAW,GAAG,CAAC,wCAAwC,EAAE;AAC1D,MAAC,KAAK,GAAG;;;;"}